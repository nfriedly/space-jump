!function(t){"use strict";var e={};e.mapValue=function(t,e,i,a,n){return(t-e)*(n-a)/(i-e)+a},e.mapToArray=function(t,i,a,n){return n[Math.floor(e.mapValue(t,i,a+1,0,n.length))]},t.Util=e}(this),function(t){"use strict";var e={debug:!1};document.getElementById("debug").onclick=function(){e.debug=!e.debug},t.Settings=e}(this),function(t){"use strict";function e(t){return t.reduce(function(t,e){return Math.max(t,l.measureText(e).width)},0)}function i(){var t=Date.now(),i=Math.round(1e5/(t-r))/100;r=t;var a=5,o=5,h=14,f=Object.keys(Player).filter(function(t){return"function"!=typeof Player[t]}).map(function(t){return t+": "+Player[t]}).concat(["offset: "+n.getOffset(),"platforms: "+Platforms.getVisiblePlatforms().length+"/"+Platforms.length,"fps: "+i,"% complete: "+Math.round(n.getOffset()/Platforms.GAME_HEIGHT*1e4)/100]).concat(Object.keys(MobileInput.inputMap).map(function(t){return"Mobile "+t+": "+MobileInput.inputMap[t]}));l.font="10pt Helvetica",l.textBaseline="top";var u=e(f);l.fillStyle="rgba(0,0,0,0.8)",l.fillRect(0,0,u+2*o,f.length*h+2*a),l.fillStyle="lime",f.forEach(function(t,e){l.fillText(t,o,e*h+a)})}function a(){l.fillStyle="black",l.fillRect(0,0,n.width,n.height)}var n=document.getElementById("game-window"),l=n.getContext("2d");n.getOffset=function(){return Player.y-n.height/2},n.mapY=function(t,e,i){return e=e||0,i=i||n.getOffset(),n.height-(t-i)-e};var r=Date.now();n.drawDialog=function(t,i){l.font="20px Helvetica",l.textBaseline="top";var a=t.split("\n"),r=30,o=e(a)+2*r,h=25,f=a.length*h+2*r-5,u=n.width/2-o/2,s=n.height/2-f/2;l.fillStyle=i||"rgba(255, 255, 255, 0.8)",l.fillRect(u,s,o,f),l.fillStyle="white",a.forEach(function(t,e){l.fillText(t,n.width/2-l.measureText(t).width/2,s+r+e*h)})},n.render=function(){Background.image.loaded?Background.draw(l):a(),Platforms.draw(l),Player.draw(l),Player.drawFuelGuage(l),Player.drawMiniMap(l),Settings.debug&&i()},t.Canvas=n}(this),function(t){"use strict";function e(t,e,i){this.x=t,this.y=e,this.width=i}var i=2;e.prototype.height=i,e.prototype.isPlanet=!1,e.prototype.toString=function(){var t=["(",this.x,"+",this.width,", ",this.y,")"];return this.isPlanet&&t.unshift("Planet:"),t.join("")},e.prototype.getPath=function(){if(this._path)return this._path;for(var t,e=this,i=!this.isPlanet,a=[{x:e.x,y:e.y}],n=e.x,l=e.x+e.width;;){if(n+=Math.max(1,Math.abs(21*Math.cos(n))),n>l)break;t=e.y+3*Math.cos(n)+(i?-4:4),t=i?Math.min(e.y+1,t):Math.max(e.y-1,t),a.push({x:n,y:t})}var r=i?e.y+e.height:e.y-e.height;return a.push({x:l,y:e.y}),a.push({x:l,y:r}),a.push({x:e.x,y:r}),this._path=a,a},e.prototype.draw=function(t,e){var i=this,a=Canvas.mapY(i.y,i.height,t),n=e.createLinearGradient(i.x,a,i.x+2*i.width/3,2*i.height);n.addColorStop(0,"#887723"),n.addColorStop(1,"#662211"),e.fillStyle=n;var l=i.getPath();e.beginPath(),l.forEach(function(a){e.lineTo(a.x,Canvas.mapY(a.y,i.height,t))}),e.fill()};var a=Canvas.height/2,n=new e(0,0-a,Canvas.width);n.isPlanet=!0,n.height=a;for(var l=[n],r=n,o=1;100>=o;o++){var h=r.y+r.height+60+Math.round(100*Math.abs(Math.cos(o)))+2*o,f=60+Math.round(150*Math.abs(Math.sin(o))-1.5*o),u=Canvas.width/2+Math.round(Math.cos(o)*Canvas.width/2)-f/2;r=new e(u,h,f),l.push(r)}l.GAME_HEIGHT=l[l.length-1].y+Canvas.height/2,l.getVisiblePlatforms=function(){var t=Canvas.getOffset(),e=t+Canvas.height;return l.filter(function(i){return i.y+i.height>t&&i.y<e})},l.draw=function(t){var e=l.getVisiblePlatforms(),i=Canvas.getOffset();e.forEach(function(e){e.draw(i,t)})},t.Platforms=l}(this),function(t){"use strict";var e=15,i=40,a=40,n=20,l=2,r=10,o=10,h=6,f=3,u=6.5,s={x:Platforms[0].x+Platforms[0].width/2-e/2,y:0,velocityX:0,velocityY:0,isOnPlatform:!0,width:e,fuel:i,isWaitingOnFuel:!1};s.tick=function(t,e){var c=t*h,v=t*f,g=t*o,y=t*u,d=t*a;s.fuel>l&&(s.isWaitingOnFuel=!1),s.isWaitingOnFuel||(e.up&&(s.velocityY=Math.min(s.velocityY+e.up*g,r),s.fuel=Math.max(0,s.fuel-e.up*d)),e.left&&(s.velocityX=Math.max(s.velocityX-e.left*g,-r),s.fuel=Math.max(0,s.fuel-e.left*d)),e.right&&(s.velocityX=Math.min(s.velocityX+e.right*g,r),s.fuel=Math.max(0,s.fuel-e.right*d))),s.fuel<=0&&(s.isWaitingOnFuel=!0),s.up||(s.fuel=Math.min(i,s.fuel+t*n));var p=Platforms.getVisiblePlatforms().filter(function(t){return s.x+s.width+1>=t.x&&s.x<=t.x+t.width}),m=Math.round(s.y),w=p.some(function(t){return m===t.y+t.height});s.isOnPlatform=w,s.velocityX>0?s.velocityX=Math.max(0,s.velocityX-v-(w?y:0)):s.velocityX<0&&(s.velocityX=Math.min(0,s.velocityX+v+(w?y:0))),s.velocityY=Math.max(-r,s.velocityY-c),w&&s.velocityY<0&&(s.velocityY=0),s.x=Math.min(Canvas.width-s.width,Math.max(0,s.x+s.velocityX));var M=s.velocityY<0&&p.filter(function(t){return s.y>t.y+t.height&&s.y+s.velocityY<=t.y+t.height})[0];M?(s.y=M.y+M.height,s.velocityY=0,s.isOnPlatform=!0):s.y+=s.velocityY},s.draw=function(t){t.fillStyle="#ffffff",t.beginPath();var e=s.x,i=Canvas.mapY(s.y);t.moveTo(e+4,i-3),t.quadraticCurveTo(e-1,i-4,e,i+2),t.bezierCurveTo(e,i-9,e+1,i-10,e+4,i-10),t.lineTo(e+4,i-25),t.bezierCurveTo(e+4,i-27,e+5,i-30,e+7,i-30),t.bezierCurveTo(e+8,i-30,e+9,i-27,e+10,i-27),t.lineTo(e+10,i-10),t.bezierCurveTo(e+13,i-9,e+14,i-10,e+14,i+2),t.quadraticCurveTo(e+15,i-4,e+10,i-3),t.fill(),t.fillStyle="#8888ff",t.beginPath(),t.arc(e+7,i-26,2,0,2*Math.PI,!1),t.fill();var a=(new Date).getMilliseconds(),n=[3,5,2,7],l=Util.mapToArray(a,0,999,n);if(!s.isWaitingOnFuel){var r=Input.getInputs();r.up&&(t.fillStyle="#FF1D0E",t.beginPath(),t.moveTo(e+4,i-2),t.lineTo(e+10,i-2),t.lineTo(e+7,i+9+l),t.fill(),t.fillStyle="#FFDF0C",t.beginPath(),t.moveTo(e+4,i-2),t.lineTo(e+10,i-2),t.lineTo(e+7,i+5+l),t.fill()),r.right>.1&&(t.fillStyle="#FF1D0E",t.beginPath(),t.moveTo(e+4,i-20),t.lineTo(e+4,i-14),t.lineTo(e-3-l*r.right,i-17),t.fill(),t.fillStyle="#FFDF0C",t.beginPath(),t.moveTo(e+4,i-20),t.lineTo(e+4,i-14),t.lineTo(e-l*r.right,i-17),t.fill()),r.left>.1&&(t.fillStyle="#FF1D0E",t.beginPath(),t.moveTo(e+10,i-20),t.lineTo(e+10,i-14),t.lineTo(e+17+l*r.left,i-17),t.fill(),t.fillStyle="#FFDF0C",t.beginPath(),t.moveTo(e+10,i-20),t.lineTo(e+10,i-14),t.lineTo(e+14+l*r.left,i-17),t.fill())}t.beginPath(),t.moveTo(e+7,i-10),t.lineTo(e+7,i),t.stroke(),t.fillStyle="#ffffff",t.beginPath(),t.arc(e+4,i-17,3,0,2*Math.PI,!1),t.fill(),t.fillStyle="#ffffff",t.beginPath(),t.arc(e+10,i-17,3,0,2*Math.PI,!1),t.fill()},s.drawFuelGuage=function(t){t.strokeStyle="rgba(0, 121, 248, 0.8)",t.fillStyle="rgba(0, 121, 248, 0.7)",t.font="10px Helvetica, sans-serif";var e="FUEL",a=t.measureText(e).width;t.lineWidth=1;var n=40,l=10;t.fillText(e,Canvas.width-(a+n+2*l),l),t.strokeRect(Canvas.width-(n+l),l,n,10),t.fillRect(Canvas.width-(n+l),l,n*s.fuel/i,10)},s.drawMiniMap=function(t){t.strokeStyle="rgba(0, 121, 248, 0.8)",t.fillStyle="rgba(0, 121, 248, 0.7)";var e=10,i=100+2*t.lineWidth;t.lineWidth=1;var a=40+2*t.lineWidth;t.fillRect(Canvas.width-(a+e),Canvas.height-e-i,a,i),t.strokeRect(Canvas.width-(a+e),Canvas.height-e-i,a,i),t.font="10px Helvetica, sans-serif";var n="MAP",l=t.measureText(n).width,r=12;t.fillText(n,Canvas.width-(l+a+2*e),Canvas.height-e-r),t.fillStyle="#887723",t.globalAlpha=.8,t.beginPath(),t.arc(Canvas.width-a/2-e,Canvas.height-e+36,a,Math.PI/180*240,Math.PI/180*300),t.fill(),t.globalAlpha=1;var o=Canvas.height-(e+Util.mapValue(s.y,0,Platforms.GAME_HEIGHT,9,i)),h=Canvas.width-a/2-e;t.fillStyle="#ffffff",t.beginPath(),t.moveTo(h-3,o+3),t.lineTo(h+3,o+3),t.lineTo(h,o-3),t.fill()},t.Player=s}(this),function(t){"use strict";var e={};e.image=new Image,e.image.onload=function(){e.image.loaded=!0};var i=Canvas.width>400?"800":"400";e.image.src="images/PIA17843-"+i+".jpg",e.draw=function(t){var i=e.image,a=Util.mapValue(Player.y,0,Platforms.GAME_HEIGHT,Canvas.height-i.height,0);t.drawImage(i,0,a)},t.Background=e}(this),function(t){"use strict";function e(t){var e=o[t.keyCode];e&&(h[e]=!0)}function i(t){var e=o[t.keyCode];e&&(h[e]=!1)}var a={},n="up",l="left",r="right",o=[];o[38]=n,o[37]=l,o[39]=r;var h=a.inputMap={up:!1,left:!1,right:!1};window.addEventListener("keydown",e,!0),window.addEventListener("keyup",i,!0),t.Keyboard=a}(this),function(t){"use strict";var e={},i=e.inputMap={up:0,left:0,right:0};Canvas.addEventListener("touchstart",function(){i.up=1},!0),Canvas.addEventListener("touchend",function(){i.up=0},!0),window.addEventListener("deviceorientation",function(t){var e=Util.mapValue(Math.abs(t.gamma),0,40,0,1);e=Math.min(1,e),t.gamma>0?(i.left=0,i.right=e):(i.left=e,i.right=0)},!0),t.MobileInput=e}(this),function(t){"use strict";var e={getInputs:function(){return{up:(Keyboard.inputMap.up?1:0)+MobileInput.inputMap.up,left:(Keyboard.inputMap.left?1:0)+MobileInput.inputMap.left,right:(Keyboard.inputMap.right?1:0)+MobileInput.inputMap.right}}};t.Input=e}(this),function(){"use strict";function t(){var n=Date.now(),l=(n-a)/1e3;a=n;var r=Input.getInputs();switch(i){case e.START:r.up?i=e.PLAYING:(Canvas.render(),Canvas.drawDialog("Escape the planet's gravity!\nPress ↑⃞ or touch screen.","rgba(10, 4, 133, 0.8)"));break;case e.PLAYING:Player.tick(l,r),Player.y>=Platforms.GAME_HEIGHT&&(i=e.WIN),Canvas.render();break;case e.WIN:Canvas.render(),Canvas.drawDialog("You win!","rgba(30, 255, 30, 0.8)")}requestAnimationFrame(t)}var e={START:"start",PLAYING:"playing",WIN:"win"},i=e.START,a=Date.now();t()}();