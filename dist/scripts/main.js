!function(){"use strict";function t(t,e,i){this.x=t,this.y=e,this.width=i}function e(){return E.y-s.height/2}function i(){var t=e(),i=t+s.height;return m.filter(function(e){return e.y>t&&e.y<i})}function n(t,i,n){return i=i||0,n=n||e(),s.height-(t-n)-i}function a(){var t=i(),n=e();t.forEach(function(t){t.draw(n)})}function o(){v.fillStyle="#000000",v.fillRect(E.x,n(E.y,S),20,20)}function h(){var t=5,n=5,a=14,o=Object.keys(E).map(function(t){return t+": "+E[t]}).concat(["offset: "+e(),"platforms: "+i().length+"/"+m.length]);v.font="10pt Helvetica",v.textBaseline="top";var h=o.reduce(function(t,e){return Math.max(t,v.measureText(e).width)},0);v.fillStyle="rgba(0,0,0,0.8)",v.fillRect(0,0,h+2*n,o.length*a+2*t),v.fillStyle="lime",o.forEach(function(e,i){v.fillText(e,n,i*a+t)})}function r(t,e){v.font="20px Helvetica",v.textBaseline="top";var i=10,n=v.measureText(t).width+2*i,a=40,o=s.width/2-n/2,h=s.height/2-a/2;v.fillStyle=e||"rgba(255, 255, 255, 0.8)",v.fillRect(o,h,n,a),v.fillStyle="white",v.fillText(t,o+i,h+i)}function l(){v.clearRect(0,0,s.width,s.height)}function c(){l(),a(),o(),u&&h()}function y(){if(!T){var t=Date.now(),e=(t-C)/1e3;C=t;var n=e*X,a=i().filter(function(t){return E.x+k+1>=t.x&&E.x<=t.x+t.width}),o=Math.round(E.y),h=a.some(function(t){return o===t.y+x});E.isOnPlatform=h,E.velocityX>0?E.velocityX=Math.max(0,E.velocityX-n):E.velocityX<0&&(E.velocityX=Math.min(0,E.velocityX+n)),E.velocityY=Math.max(-Y,E.velocityY-n),h&&E.velocityY<0&&(E.velocityY=0),E.x=Math.min(s.width-k,Math.max(0,E.x+E.velocityX));var l=E.velocityY<0&&a.filter(function(t){return E.y>t.y&&E.y+E.velocityY<=t.y})[0];l?(E.y=l.y+x,E.velocityY=0,E.isOnPlatform=!0):E.y+=E.velocityY,E.y<0?(T=!0,r("Game over","rgba(255,0,0,0.8)")):(c(),requestAnimationFrame(y))}}function f(t){switch(t.keyCode){case 38:E.velocityY=Math.min(E.velocityY+P,Y);break;case 40:E.velocityY=Math.max(E.velocityY-P,-Y);break;case 37:E.velocityX=Math.max(E.velocityX-P,-Y);break;case 39:E.velocityX=Math.min(E.velocityX+P,Y)}}var u=!0,s=document.getElementById("game-window"),v=s.getContext("2d"),x=2;t.prototype.height=x,t.prototype.isPlanet=!1,t.prototype.toString=function(){var t=["(",this.x,"+",this.width,", ",this.y,")"];return this.isPlanet&&t.unshift("Planet:"),t.join("")},t.prototype.getPath=function(){if(this._path)return this._path;for(var t,e=this,i=!this.isPlanet,n=[{x:e.x,y:e.y}],a=e.x,o=e.x+e.width;;){if(a+=Math.max(1,Math.abs(21*Math.cos(a))),a>o)break;t=e.y+3*Math.cos(a)+(i?-4:4),t=i?Math.min(e.y+1,t):Math.max(e.y-1,t),n.push({x:a,y:t})}var h=i?e.y+e.height:e.y-e.height;return n.push({x:o,y:e.y}),n.push({x:o,y:h}),n.push({x:e.x,y:h}),this._path=n,n},t.prototype.draw=function(t){var e=this,i=n(e.y,x,t),a=v.createLinearGradient(e.x,i,e.x+2*e.width/3,2*e.height);a.addColorStop(0,"#887723"),a.addColorStop(1,"#662211"),v.fillStyle=a;var o=e.getPath();v.beginPath(),o.forEach(function(t){v.lineTo(t.x,n(t.y))}),v.fill()};var d=new t(0,.75*s.height-x,s.width);d.isPlanet=!0,d.height=s.height/2;for(var m=[d],w=d,g=1;100>=g;g++){var p=w.y+60+Math.round(100*Math.abs(Math.cos(g)))+2*g,M=60+Math.round(150*Math.abs(Math.sin(g))-1.5*g),b=s.width/2+Math.round(Math.cos(g)*s.width/2)-M/2;w=new t(b,p,M),m.push(w)}var Y=10,P=1,X=2.5,S=20,k=20,E={x:m[0].x+m[0].width/2-k/2,y:m[0].y+x,velocityX:0,velocityY:0,isOnPlatform:!0},T=!1,C=Date.now();s.onclick=function(){T=!T,T?r("Paused","rgba(0,0,255,0.8)"):(C=Date.now(),y())},window.addEventListener("keydown",f,!0),y()}();